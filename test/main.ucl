const js = @import("./js.ucl");

const Vec2 = struct {
	field x: Number;
	field y: Number;
	
	const new = fn(x: Number, y: Number): Vec2 {
		ret Vec2 {
			.x = x;
			.y = y;
		};
	};
	
	const add = fn(v1: Vec2, v2: Vec2): Vec2 {
		ret Vec2.new(v1.x + v2.x, v1.y + v2.y);
	};
};

const main = fn(): js.Dictionary(Vec2) {
	// var a = Vec2 {
	// 	.x = @opaque(1);
	// 	.y = @opaque(2);
	// };
	// ret a.add(Vec2.new(@opaque(1), @opaque(2)));
	var dictionary = js.Dictionary(Vec2).new();
	dictionary.set("a", Vec2.new(1, 1));
	dictionary.set("b", Vec2.new(22, 22));
	dictionary.set("c", Vec2.new(333, 333));
	@compileDebug(dictionary);
	ret dictionary;
};
@export("main", main);

//////////////////////////////

// const function = fn(aIn: String): 'Any {
// 	const String2 = struct {
// 		property a: String;
// 		property b: String;
		
// 		const new = fn(bIn: String): String2 {
// 			@compileDebug();
// 			ret struct: String2 {
// 				a = aIn;
// 				b = bIn;
// 			};
// 		};
// 	};
// 	ret String2;
// };

// var string2: 'function("a") = function("a").new(@opaque("b"));

// @addTopCodeGen(string2.a);
// @addTopCodeGen("\n");
// @addTopCodeGen(string2.b);

//////////////////////////////

// const Vec2 = struct {
// 	field x: Number;
// 	field y: Number;
	
// 	const new = fn(x: Number, y: Number): Vec2 {
// 		ret Vec2 {
// 			.x = x;
// 			.y = y;
// 		};
// 	};
// };

// comptime var a: Vec2 = Vec2.new(1, @opaque(2));
// @compileDebug(a);

// const Vec2 = struct {
// 	field x: Number;
// 	field y: Number;
	
// 	const new = fn(x: Number, y: Number): Vec2 {
// 		ret Vec2 {
// 			.x = x;
// 			.y = y;
// 		};
// 	};
	
// 	const add = fn(v1: Vec2, v2: Vec2): Vec2 {
// 		ret Vec2.new(v1.x + v2.x, v1.y + v2.y);
// 	};
// };

// comptime {
// 	var a = Vec2.new(1, 2);
// 	var b = Vec2.new(3, 4);

// 	var c = Vec2.add(a, b);
// 	@assert(c.x == 4);
// 	@assert(c.y == 6);

// 	var d = a.add(b);
// 	@assert(d.x == 4);
// 	@assert(d.y == 6);
// }